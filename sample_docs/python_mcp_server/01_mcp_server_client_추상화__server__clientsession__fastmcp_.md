# Chapter 1: MCP Server/Client μ¶”μƒν™” (Server, ClientSession, FastMCP)

---

## λ™κΈ°: μ™ μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ μ¶”μƒν™”κ°€ μ¤‘μ”ν• κΉμ”?

μ—¬λ¬λ¶„μ΄ μ±—λ΄‡, AI λ¨λΈ, λ„κµ¬ μλ™ν™” λ“±μ μ‹μ¤ν…μ„ λ§λ“ λ‹¤κ³  μƒμƒν•΄ λ³΄μ„Έμ”. μ™Έλ¶€μ—μ„ λ‚΄ ν”„λ΅κ·Έλ¨μ κΈ°λ¥μ„ μ‚¬μ©ν•  μ μλ„λ΅ λ§λ“¤κ³  μ‹¶μΌλ©΄, "μ„λ²„"μ™€ "ν΄λΌμ΄μ–ΈνΈ"λΌλ” κ°λ…μ΄ κΌ­ ν•„μ”ν•©λ‹λ‹¤.

- **μ„λ²„(Server)**: κΈ°λ¥(λ„κµ¬, λ¦¬μ†μ¤, ν”„λ΅¬ν”„νΈ λ“±)μ„ μ™Έλ¶€μ— κ³µκ°(λ…Έμ¶)ν•©λ‹λ‹¤. μ¦‰, μ κ³µμ μ—­ν• μ„ ν•©λ‹λ‹¤.
- **ν΄λΌμ΄μ–ΈνΈ(ClientSession)**: μ„λ²„μ— μ—°κ²°ν•΄μ„ κΈ°λ¥μ„ μ”μ²­ν•κ³  κ²°κ³Όλ¥Ό λ°›λ” μ†λΉ„μμ…λ‹λ‹¤.
- **FastMCP**: μ„λ²„λ¥Ό λ” μ‰½κ² λ§λ“¤ μ μκ² λ„μ™€μ£Όλ” κ³ μμ¤€(μƒμ„λ λ²¨) λνΌμ…λ‹λ‹¤.

MCP ν”„λ΅μ νΈμ—μ„λ” κ°κ°μ μ—­ν• μ„ μ κµ¬λ¶„ν•κ³ , μ‰½κ² λ‹¤λ£° μ μλ„λ΅ μ¶”μƒν™”ν•΄μ„ μ κ³µν•©λ‹λ‹¤. μ¦‰, λ³µμ΅ν•¨μ„ κ°μ¶”κ³  μ‹¬ν”ν• μΈν„°νμ΄μ¤λ΅ λ°”κΏ”μ¤λ‹λ‹¤.

---

## ν•µμ‹¬ μ•„μ΄λ””μ–΄

1. **Serverμ™€ ClientSessionμ€ MCPμ ν•µμ‹¬**  
   κ°λ°μλ” Server/ClientSession ν΄λμ¤ λ•λ¶„μ— λ³µμ΅ν• λ„¤νΈμ›ν¬ μ½”λ“λ¥Ό μ‘μ„±ν•μ§€ μ•κ³ , μ‰½κ² μ„λ²„λ¥Ό λ§λ“¤κ±°λ‚ λ¶™μ„ μ μμµλ‹λ‹¤.

2. **μ¶”μƒν™”λ€?**  
   λ¶ν•„μ”ν• λ³µμ΅ν•¨μ„ μ¨κΈ°κ³ , κΌ­ ν•„μ”ν• 'λ™μ‘'λ§ λ³΄μ—¬μ£Όλ” κ²ƒ.  
   μ‹¤μ λ΅λ” λ§μ€ μ½”λ“μ™€ ν†µμ‹ μ΄ μ¨μ–΄ μμ–΄λ„, μ—¬λ¬λ¶„μ€ 'ν•„μ”ν• κ²ƒλ§ λ³΄λ©΄' λ©λ‹λ‹¤.

3. **FastMCPλ΅ λ” μ‰½κ²!**  
   FastMCPλ” λ°μ½”λ μ΄ν„°, νΈλ¦¬ν• ν¨ν„΄ λ“± νμ΄μ¬μ μ¥μ μ„ μ΄μ©ν•΄ μ„λ²„ μ½”λ“λ¥Ό λ” μ‰½κ² μ§¤ μ μλ„λ΅ ν•΄μ¤λ‹λ‹¤.

---

## μ½”λ“: μ–΄λ””μ„ λ¬΄μ—‡μ„ λ¶λ¬μ™€μ•Ό ν• κΉμ”?

### MCP κΈ°λ³Έ κµ¬μ„±

μ•„λ νμΌμ—μ„, MCPμ μ£Όμ” μ»΄ν¬λ„νΈ(Server, ClientSession, FastMCP λ“±)λ¥Ό λ¶λ¬μµλ‹λ‹¤.

```python
# src/mcp/__init__.py μΌλ¶€ λ°μ·

from .client.session import ClientSession
from .server.session import ServerSession
from .server.fastmcp import FastMCP
```

### μ„λ²„(μ κ³µμ)μ™€ ν΄λΌμ΄μ–ΈνΈ(μ†λΉ„μ)

- **μ„λ²„(Server, FastMCP)**  
  - λ‚΄ ν”„λ΅κ·Έλ¨μ΄ μ™Έλ¶€ μ”μ²­μ„ λ°›κ³ , λ„κµ¬Β·λ¦¬μ†μ¤Β·ν”„λ΅¬ν”„νΈ λ“± μ—¬λ¬ κΈ°λ¥μ„ μ™Έλ¶€μ— κ³µκ°ν•λ ¤λ©΄ μ΄κ±Έ μ”λ‹λ‹¤.

- **ν΄λΌμ΄μ–ΈνΈ(ClientSession)**  
  - μ΄λ―Έ μ¤€λΉ„λ MCP μ„λ²„μ— λ¶™μ–΄μ„, μ κ³µν•λ” κΈ°λ¥μ„ μ‚¬μ©ν•  λ• μ”λ‹λ‹¤.

### μμ‹ μ½”λ“ 1) μ„λ²„ λ§λ“λ” κ°€μ¥ κ°„λ‹¨ν• λ°©λ²•

```python
from mcp.server.fastmcp import FastMCP

server = FastMCP(name="λ‚μ μ„λ²„", instructions="μ΄ μ„λ²„λ” ν…μ¤νΈμ©μ…λ‹λ‹¤.")

@server.tool()
def add(a: int, b: int) -> int:
    return a + b

if __name__ == "__main__":
    server.run("stdio")
```

### μμ‹ μ½”λ“ 2) ν΄λΌμ΄μ–ΈνΈλ΅ μ„λ²„μ— μ ‘μ† ν›„ κΈ°λ¥ μ‚¬μ©

```python
from mcp import ClientSession, stdio_client

async def main():
    async with stdio_client() as (read, write):
        session = ClientSession(read, write)
        await session.initialize()
        result = await session.call_tool("add", {"a": 1, "b": 2})
        print(result)
```

---

## μ½”λ“ μ„¤λ…: μ–΄λ–»κ² λ™μ‘ν• κΉμ”?

### 1. FastMCPλ΅ λ§λ“  μ„λ²„

- `FastMCP` λ” μ„λ²„μ κ»λ°κΈ°λ¥Ό λ§λ“­λ‹λ‹¤.
- `@server.tool()` λ°μ½”λ μ΄ν„°λ¥Ό λ¶™μ΄λ©΄, κ°„λ‹¨ν Python ν•¨μλ¥Ό μ™Έλ¶€ "λ„κµ¬"λ΅ λ“±λ΅ν•  μ μμµλ‹λ‹¤.
- `server.run("stdio")` λ¥Ό νΈμ¶ν•λ©΄, μ„λ²„κ°€ μ‹¤ν–‰λκ³  μ™Έλ¶€μ—μ„ μ”μ²­μ„ λ°›μ„ μ¤€λΉ„κ°€ λ©λ‹λ‹¤.

> **λΉ„μ :**  
> λ§μΉ μΉ΄νμ μ£Όλ°©μ¥(μ„λ²„)μ΄, μ¤λμ λ©”λ‰΄(λ„κµ¬)λ¥Ό λ―Έλ¦¬ μ¤€λΉ„ν•΄λ†“κ³  μ†λ‹(ν΄λΌμ΄μ–ΈνΈ)μ΄ μ¤λ©΄ μ£Όλ¬Έμ„ μ²λ¦¬ν•λ” κ²ƒκ³Ό κ°™μµλ‹λ‹¤.

### 2. ClientSessionμΌλ΅ μ„λ²„μ™€ λ€ν™”

- `ClientSession` κ°μ²΄λ¥Ό λ§λ“¤ λ• μ—°κ²° μ¤νΈλ¦Ό(read/write stream)μ„ λ„κΉλ‹λ‹¤.
- `initialize()`λ¥Ό νΈμ¶ν•λ©΄ μ„λ²„ μ—°κ²°μ΄ μ‹μ‘λ©λ‹λ‹¤(μ„λ΅ "μ¤€λΉ„ μ™„λ£" μ‹ νΈ μ£Όκ³ λ°›μ).
- `call_tool("add", {"a": 1, "b": 2})` ν•¨μλ΅ μ„λ²„μ— μλ” addλΌλ” λ„κµ¬λ¥Ό μ‹¤μ λ΅ νΈμ¶ν•¨.
- κ²°κ³Όλ¥Ό λ°›μ•„μ„ ν™μ©ν•©λ‹λ‹¤.

> **λΉ„μ :**  
> μ†λ‹(ν΄λΌμ΄μ–ΈνΈ)μ΄ μΉ΄ν μΉ΄μ΄ν„°(μ„Έμ…)μ—μ„ "μ»¤ν”Ό ν• μ”(add)"μ„ μ£Όλ¬Έν•κ³ , μ£Όλ°©(μ„λ²„)μ—μ„ "μ»¤ν”Ό ν• μ”"μ„ λ‚΄μ¤λ‹λ‹¤.

---

## μμ£Όν•λ” μ§λ¬Έ

### Q1. FastMCPμ™€ Serverμ μ°¨μ΄μ μ€?
- `Server`λ” MCP ν”„λ΅ν† μ½μ μ €μμ¤€(λ‚®μ€ μμ¤€) κΈ°λ¥μ„,  
- `FastMCP`λ” λ” μ‰½κ³  νμ΄μ¬μ¤λ½κ²(λ°μ½”λ μ΄ν„° λ“±) μ„λ²„λ¥Ό λ§λ“¤ μ μκ² λν•‘(wrap)ν•΄μ¤λ‹λ‹¤.

### Q2. ν΄λΌμ΄μ–ΈνΈλ„ μ§μ ‘ λ„κµ¬λ¥Ό λ“±λ΅ν•  μ μλ‚μ”?
- μ•„λ‹μ”. ν΄λΌμ΄μ–ΈνΈλ” **μ‚¬μ©ν•λ” μ…μ¥**μ΄κ³ ,  
  λ„κµ¬/λ¦¬μ†μ¤/ν”„λ΅¬ν”„νΈ λ“±μ€ **μ„λ²„**μ—λ§ λ“±λ΅λ©λ‹λ‹¤.

---

## λ§λ¬΄λ¦¬: μ΄ μ¥μ ν•µμ‹¬ μ”μ•½

- MCPμ **μ„λ²„**μ™€ **ν΄λΌμ΄μ–ΈνΈ** μ¶”μƒν™” λ•λ¶„μ—, λ³µμ΅ν• λ„¤νΈμ›ν¬ μ½”λ“λ¥Ό λ°λΌλ„  
  μ†μ‰½κ² "κΈ°λ¥ μ κ³µμ(μ„λ²„)"μ™€ "κΈ°λ¥ μ†λΉ„μ(ν΄λΌμ΄μ–ΈνΈ)"λ¥Ό κµ¬ν„ν•  μ μμµλ‹λ‹¤.

- `FastMCP`λ¥Ό μ“°λ©΄ νμ΄μ¬μ¤λ¬μ΄ μ½”λ“λ΅, κ·Έλƒ¥ ν•¨μλ¥Ό λ§λ“¤κ³  λ°μ½”λ μ΄ν„°λ§ λ¶™μ—¬λ„ μ„λ²„ κΈ°λ¥μ΄ μƒκΉλ‹λ‹¤.

- ν΄λΌμ΄μ–ΈνΈλ” μ¤€λΉ„λ μ„λ²„μ— λ¶™μ–΄μ„, μ κ³µλ κΈ°λ¥μ„ λ§μκ» μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

---

λ‹¤μ μ¥μ—μ„λ” **ν΄/λ¦¬μ†μ¤/ν”„λ΅¬ν”„νΈ λ§¤λ‹μ €**κ°€ μ‹¤μ λ΅ MCP μ„λ²„μ—μ„ μ–΄λ–¤ μ—­ν• μ„ ν•λ”μ§€,  
κ·Έλ¦¬κ³  μ–΄λ–»κ² λ“±λ΅κ³Ό κ΄€λ¦¬κ°€ μ΄λ£¨μ–΄μ§€λ”μ§€ μ•μ•„λ³΄κ² μµλ‹λ‹¤! π©

---